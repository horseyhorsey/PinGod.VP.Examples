# 5. Inputs and VP Switches
---

## Adding Switch to Machine Class
---

Instead of having a pile of files extra to configure, the `Coils, Switches, Lamps` are in the `Machine` class.

Use the `PinGodGame` methods `AddCustomSwitches`. Check the already added switches below

You can find some custom added as an example `Machine.Switches.Add("mball_saucer", new Switch(27));`.

Switches also need an `action` in godots `InputMap`. These can be added inside the `project settings` or in the `project.godot` file.

See the BasicGame example Input maps. They should be added with the `sw` prefix `sw69`.

## Using the switch
---

See the example classes. These can be used in `_Input` overridden methods

`pinGod = GetNode("/root/PinGodGame") as PinGodGame`
`pinGod.SwitchOff("plunger_lane", inputEvent)`  ' Switch off from collection
`pinGod.SwitchOn("plunger_lane", inputEvent)`  ' switch on from collection

Example in `Tilt.cs`

```
	public override void _Input(InputEvent input)
	{
		if (!pinGod.GameInPlay) return;
		if (pinGod.IsTilted) return;

		if (pinGod.SwitchOn("tilt", input))
		{
            Print("The player is nudging the machine");
        }
    }
```

`SwitchOn` also has a check if the switch is held down, so this holds our states.

Switches can be also be triggered from the `OscService`. (TODO: Ball search settings for switches)

## Visual Pinball
---

### Auto Switch handlers
---

- Add a `Spinner` to the table. If we add this `Spinner` to the top of plunger lane we can get instant feedback when we launch the ball.
- In the `Spinners` properties add the number `27` to the `TimerInterval`
- Add the `Spinner` to the `AllSwitches` collection by right clicking and `Add/Assign to collection` 

### Manual script
---

Standard

```
Sub sw_plunger_lane_hit() : Controller.Switch 20, 1 :  End Sub   
Sub sw_plunger_lane_unhit() : Controller.Switch 20, 0 :  End Sub
```

VPM Pulse Switch

`vpmTimer.PulseSw 26`

## Default

```
    public static readonly Switches Switches = new Switches()
    {
        {"coin",        new Switch(2)},
        {"exit",        new Switch(4)},
        {"down",        new Switch(5)},
        {"up",          new Switch(6)},
        {"enter",       new Switch(7)},
        {"flipper_l",   new Switch(11)},
        {"flipper_r",   new Switch(9)},
        {"slam_tilt",   new Switch(16)},
        {"tilt",        new Switch(17)},
        {"start",       new Switch(19)},
        {"plunger_lane",new Switch(20)},
        {"outlane_l",   new Switch(21)},
        {"inlane_l",    new Switch(22)},
        {"inlane_r",    new Switch(23)},
        {"outlane_r",   new Switch(24)},
        {"sling_l",     new Switch(25)},
        {"sling_r",     new Switch(26)},
        {"trough_1",    new Switch(81)},
        {"trough_2",    new Switch(82)},
        {"trough_3",    new Switch(83)},
        {"trough_4",    new Switch(84)},
    };

    public static readonly Lamps Lamps = new Lamps()
    {
        {"shoot_again",        1}
    };
```
